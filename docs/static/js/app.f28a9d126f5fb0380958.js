webpackJsonp([1],{"0BqW":function(e,t){},"1/oy":function(e,t){},"1IkK":function(e,t){},"3MRc":function(e,t){},"9M+g":function(e,t){},EpXN:function(e,t){},Id91:function(e,t){},Jmt5:function(e,t){},NHnr:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,s=n("woOf"),a=n.n(s),r=n("7+uW"),i=n("Dd8w"),l=n.n(i),d=n("NYxO"),c={name:"Keyboard",data:function(){return{keyText:""}},created:function(){window.addEventListener("keydown",this.documentKeydown)},beforeDestroy:function(){window.removeEventListener("keydown",this.documentKeydown)},mounted:function(){this.value&&this.encode()},methods:{documentKeydown:function(e){var t=this;13==e.keyCode?""!=this.keyText&&(this.$bus.$emit("keyboard:keydown:enter:"+this.keyText.length,this.keyText),this.$bus.$emit("keyboard:keydown:enter:"+this.keyText.substr(0,1),this.keyText.substr(1)),this.$bus.$emit("keyboard:keydown:enter",this.keyText),this.keyText="",e.preventDefault()):(e.keyCode>=96&&e.keyCode<=105?this.keyText+=String.fromCharCode(e.keyCode-48):e.keyCode>=65&&e.keyCode<=90?this.keyText+=String.fromCharCode(e.keyCode+(e.shiftKey?0:32)):e.keyCode>=48&&e.keyCode<=57&&(this.keyText+=String.fromCharCode(e.keyCode)),8==e.keyCode&&(this.keyText=this.keyText.slice(0,-1))),window.clearTimeout(o),o=window.setTimeout(function(){t.keyText=""},1e3)}}},u={render:function(){var e=this.$createElement;return(this._self._c||e)("div",{staticClass:"keyboard"},[this._v(this._s(this.keyText))])},staticRenderFns:[]};var p=n("VU/8")(c,u,!1,function(e){n("3MRc")},null,null).exports,g=n("//Fk"),b=n.n(g),h=n("W3Iv"),f=n.n(h),m=n("pFYg"),v=n.n(m),_=n("mtWM"),y=n.n(_),k=(n("gXvN"),"http://smartsort.kazpost.kz/api/v1/");null!==localStorage.getItem("apiUrl")&&(k=localStorage.getItem("apiUrl"));var x="http://192.168.10.10/api/v1/leds";null!==localStorage.getItem("deviceip")&&(x=localStorage.getItem("deviceip"));var w=y.a.create({baseURL:k}),B=y.a.create({baseURL:x}),$="/static/audio/supermariobros/";(new Audio).src=$+"search.mp3";var C=new Audio;C.src=$+"search1.mp3";var S=new Audio;S.src=$+"push0.mp3";var A=new Audio;A.src=$+"push1.mp3";var I=new Audio;I.src=$+"push2.mp3";var T=new Audio;T.src=$+"push3.mp3";var E=new Audio;E.src=$+"push4.mp3";var M=new Audio;M.src=$+"pushcool.mp3";var L=new Audio;L.src=$+"pull.mp3";var R=new Audio;R.src=$+"notfound.mp3";var D=new Audio;D.src=$+"error.mp3";var z=new Audio;z.src=$+"bindstart.mp3";var N=new Audio;N.src=$+"bindend.mp3";var O=new Audio;O.src=$+"notbound.mp3";var P=new Audio;P.src=$+"notfoundplan.mp3";var U=new Audio;U.src=$+"bind.mp3";var G=new Audio;G.src=$+"closebag.mp3";var W=new Audio;W.src=$+"registerpoint.mp3";var F=new Audio;F.src=$+"auth.mp3";var K=0,j=0,Z=[S,A,I,T,E],q={methods:{$search:function(e){this.$ledon("color=220000&led=all&duration=10&repeat=10000"),C.currentTime=0,C.play()},$push:function(e,t){this.$ledon("color=r&led="+t+"&duration=1000&repeat=50&pause=500"),C.pause(),10==K?((j+=1)>Z.length&&(j=0),K=0,M.play()):(K+=1,console.log(j,Z.length),Z[j].currentTime=0,Z[j].play())},$pull:function(e,t){this.$ledon("color=r&led="+t+"&duration=100&repeat=3"),L.currentTime=0,L.play()},$notFound:function(e){this.$ledon("color=r&led=all&duration=50&repeat=3"),C.pause(),R.play()},$bindStart:function(){this.$ledon("color=all&led=all&duration=1000"),z.currentTime=0,z.play()},$bindEnd:function(){this.$ledon("color=all&led=all&duration=100&repeat=3"),N.play()},$closeBag:function(e){this.$ledon("color=all&led="+e+"&duration=100&repeat=50"),G.currentTime=0,G.play()},$printBag:function(e){console.log("printBag",e),B.post("/print",e)},$bind:function(e){this.$ledon("color=all&led="+e+"&duration=1000&repeat=1000&pause=100"),U.currentTime=0,U.play()},$notPlan:function(){this.$ledon("color=r&led=all&duration=50&repeat=3"),P.currentTime=0,P.play()},$notBind:function(){this.$ledon("color=r&led=all&duration=50&repeat=3"),O.currentTime=0,O.play()},$error:function(e){this.$ledon("color=r&led=all&duration=50&repeat=3"),C.pause(),D.currentTime=0,D.play()},$auth:function(e){this.$ledon("color=r&led=all&duration=1000"),F.currentTime=0,F.play()},$registerPoint:function(e){this.$ledon("color=all&led=all&duration=1000"),W.currentTime=0,W.play()},$deletePoint:function(e){this.$ledon("color=all&led="+e+"&duration=100&effect=right")},$ledon:function(e){"object"===(void 0===e?"undefined":v()(e))&&(e=f()(e).map(function(e){return e.join("=")}).join("&")),B.get("/on"+e)},$ledoff:function(){B.get("/off")}}},V=function(e){return w.get("auth?p_user="+e)},Y=function(e,t,n){return w.get("sm_home.putToBag",{params:{p_wpi:e,p_depcode:t,p_cpilslogin:n}}).then(function(e){return e.data.error?b.a.reject(e.data.error):e}).catch(function(e){if(e.response&&e.response.data.error)throw e.response.data.error;if("Network Error"==e.message)return b.a.reject("Проблема с сетью, "+k+" сервис недоступен");throw e})},H=function(e,t,n,o,s){return w.get("sm_home.closeBag",{params:{p_bag:e,p_weight:t,p_sendmeth:n,p_depcode:o,p_cpilslogin:s}}).then(function(e){return e.data.error?b.a.reject(e.data.error):e})},J=function(e){return w.get("sm_home.sortplan",{params:{p_depcode:e}})},X="/static/audio/supermariobros/",Q={search:new Audio(X+"search.mp3"),search1:new Audio(X+"search1.mp3"),push0:new Audio(X+"push0.mp3"),push1:new Audio(X+"push1.mp3"),push2:new Audio(X+"push2.mp3"),push3:new Audio(X+"push3.mp3"),push4:new Audio(X+"push4.mp3"),pushcool:new Audio(X+"pushcool.mp3"),pull:new Audio(X+"pull.mp3"),notfound:new Audio(X+"notfound.mp3"),error:new Audio(X+"error.mp3"),bindstart:new Audio(X+"bindstart.mp3"),bindend:new Audio(X+"bindend.mp3"),notbound:new Audio(X+"notbound.mp3"),notfoundplan:new Audio(X+"notfoundplan.mp3"),bind:new Audio(X+"bind.mp3"),selectbag:new Audio(X+"bind.mp3"),deselectbag:new Audio(X+"auth.mp3"),closebag:new Audio(X+"closebag.mp3"),registerpoint:new Audio(X+"registerpoint.mp3"),auth:new Audio(X+"auth.mp3"),play:function(e){"push"==e?this.playPush():(this[e].currentTime=0,this[e].play())},pushes:function(){return[this.push0,this.push1,this.push2,this.push3,this.push4]},pushCnt:0,pushCntTheme:0,playPush:function(){5==this.pushCnt?(this.pushCntTheme=this.pushCntTheme+1,this.pushCntTheme>this.pushes().length&&(this.pushCntTheme=0),this.pushCnt=0,this.pushcool.play()):(this.pushCnt=this.pushCnt+1,this.pushes()[this.pushCntTheme].currentTime=0,this.pushes()[this.pushCntTheme].play())}},ee={search:function(e){this.$ledon({color:"220000",led:"all",duration:10,repeat:1e4})},push:function(e){this.$ledon({color:"r",led:e,duration:1e3,repeat:50,pause:500})},pull:function(e){this.$ledon({color:"r",led:e,duration:100,repeat:3})},notfound:function(e){this.$ledon({color:"r",led:"all",duration:50,repeat:3})},bindstart:function(){this.$ledon({color:"all",led:"all",duration:1e3})},bindend:function(){this.$ledon({color:"all",led:"all",duration:100,repeat:3})},selectbag:function(e){this.$ledon({color:"all",led:e,duration:500,repeat:1e3})},closebag:function(e){this.$ledon({color:"all",led:e,duration:100,repeat:3})},deselectbag:function(e){this.$ledon({color:"all",led:e,duration:100,repeat:1})},printbag:function(e){B.post("/print",e)},printbagTest:function(){B.get("/testprint")},bind:function(e){this.$ledon({color:"all",led:e,duration:5e3,repeat:1})},notplan:function(){this.$ledon({color:"r",led:"all",duration:50,repeat:3})},notbind:function(){this.$ledon({color:"r",led:"all",duration:50,repeat:3})},error:function(e){this.$ledon({color:"r",led:"all",duration:50,repeat:3})},auth:function(e){this.$ledon({color:"r",led:"all",duration:1e3})},registerpoint:function(e){this.$ledon({color:"all",led:"all",duration:1e3})},deletepoint:function(e){this.$ledon({color:"all",led:e,duration:100,effect:"right"})},$ledon:function(e){B.get("/on",{params:e})},$ledoff:function(){B.get("/off")},on:function(e,t){try{this[e](t)}catch(t){console.error("Name of led "+e,t)}}},te=n("fZjL"),ne=n.n(te),oe=n("KorX"),se=n.n(oe),ae={M51:"800319",M53:"800613",M54:"850144",M55:"800808",M58:"160097",M63:"801011",M68:"801331",M70:"801416",M71:"801113",M72:"800719",M73:"770054",M74:"220081",M75:"801215",M76:"120515",M77:"800218",M84:"801519",M87:"800416",M88:"040299",M89:"041599",M90:"041099",M91:"041199",M92:"041799",M93:"040599",M300:"010000"},re=new se.a(w,{delayResponse:500}).onGet("/auth").reply(function(e){return[200,JSON.parse(e.data)]}).onGet("/putToBag").reply(200,{user:"ASEL"}).onAny("/closeBag").reply(function(e){var t=JSON.parse(e.data);return console.log("mock closeBag",t),t.count>0?[200,t]:[400,{error:"Мешок пустой!"}]}).onGet("/sortplan_json").reply(200,{user:"ASEL"}).onGet("/RR000000001KZ").reply(200,{trackid:"RR000000001KZ",status:"Впути",sender:{country:"Казахстан",name:"ИП Айгерим",address:"г.Тараз ул.Лермнотово 50"},next:{x_dep_id:"19465",dep_name:"Сарыарка ГОПС 1",address:"Астана область, г. Астана, пр. Сарыарка, д.15",postindex:"010021"}}).onGet("/RR000000002KZ").reply(200,{trackid:"RR000000002KZ",status:"Впути",sender:{country:"Казахстан",name:"ИП Айгерим",address:"г.Тараз ул.Лермнотово 50"},next:{x_dep_id:"19465",dep_name:"Сарыарка ГОПС 2",address:"Астана область, г. Астана, пр. Акыртас, д.15",postindex:"010022"}}).onGet("/RR000000003KZ").reply(200,{trackid:"RR000000003KZ",status:"Впути",sender:{country:"Казахстан",name:"ИП Айгерим",address:"г.Тараз ул.Лермнотово 50"},next:{x_dep_id:"19465",dep_name:"Сарыарка ГОПС 3",address:"Астана область, г. Астана, пр. Сейфулина, д.15",postindex:"010023"}}).onGet("/RR000000004KZ").reply(200,{trackid:"RR000000004KZ",status:"Впути",sender:{country:"Казахстан",name:"ИП Азамат",address:"г.Караганда ул.Петрова 8"},next:{x_dep_id:"19465",dep_name:"Есильский ГОПС 1",address:"Астана область, г. Астана, пр. Есиль, д.85",postindex:"010024"}}).onGet("/RR000000005KZ").reply(200,{trackid:"RR000000005KZ",status:"Впути",sender:{country:"Казахстан",name:"ИП Азамат",address:"г.Караганда ул.Петрова 8"},next:{x_dep_id:"19465",dep_name:"Есильский ГОПС 2",address:"Астана область, г. Астана, пр. Есиль, д.9",postindex:"010025"}}).onGet("/RR000000006KZ").reply(200,{trackid:"RR000000006KZ",status:"Впути",sender:{country:"Казахстан",name:"ИП Азамат",address:"г.Караганда ул.Петрова 8"},next:{x_dep_id:"19465",dep_name:"Алматинский ГОПС 1",address:"Астана область, г. Астана, пр. Момышулы, д.1",postindex:"010026"}}).onAny("/api/v1/AP005470227KZ").reply(200,{trackid:"AP005470227KZ",timestamp:"11:45:47 05.08.2018",version:"v1",status_code:"S_ISSSC",reg_date:"22.06.2018",sender:"ШЕЙНЬМАН РУСЛАН АДАМОВИЧ",sender_address:"Акмолинская Щучинск Кокчетавская 28",recipient_name:"ИП ЕСБАЕВ Д.Д.",recipient_address:"Алматинская область пос. Заречный ул. Акбулак д. 21",recepient_name_real:"Ганн.Е.А",recipient_postcode:"040003",dlv_date:"03.08.2018",dlv_dep_name:"ГОПС-6 г.Щучинск",dep_name:"Талдыкорган - 3",dlv_postindex:"021706",post_type:"4",dispute:"",x_status:"Вручено из СЦ",x_post_type_name:"Посылка",x_direction:"LOCAL",x_num_place:"",x_num_stlg:"",x_extra_info:"6,725"}).onAny("sm_home.sortplan").reply(200,{depcode:"200088",ver:1,date:"21.07.2018 18:26",plan:ae}).onAny("sm_home.putToBag").reply(function(e){var t=e.params;console.log(t);var n={p_wpi:t.p_wpi,p_cpilslogin:"SCNEVGENIA",p_depcode:"220000",toIndex:"130099",next:{bag:{bid:"913038989",bdepid:"18907",barcode:"B201807180001912",created:"18.07.18 11:09:14",user:"SCNEVGENIA"},bagIndex:"800319",bagNo:"M51"},addDetailPREGMAIL:{mlcntq:"4",wghtv:"0"}},o="M"+t.p_wpi.substr(2,2),s=ne()(ae).findIndex(function(e){return e==o});s<0&&(s=Math.floor(12*Math.random()),console.log("random",s));var a=f()(ae)[s];return n.next.bagNo=a[0],n.next.bagIndex=a[1],[200,n]}).onAny("sm_home.closeBag").reply(function(e){return[200,{closeBag:{p_bag:e.params.p_bag,p_depcode:e.params.p_depcode,p_weight:e.params.p_weight,p_sendmeth:e.params.p_sendmeth,p_cpilslogin:e.params.p_cpilslogin,bag:{barcode:"B201807180001912",todepindex:"130001",bdepid:"18907",bid:"913038989"}},cli_info:'<CLIINFO><BAGTYPE_NAME>Мешок "Сақтандыру"</BAGTYPE_NAME>\n   <BARCODE>G201807180001235</BARCODE>\n   <BARCODETOSTR>B188023542560494560155515212032164551@</BARCODETOSTR>\n   <CUSTOMCARGO />\n   <EMSFL>0</EMSFL>\n   <F51FL />\n   <FR_DEP_NAME>Участок мжд. почты г.Алматы [220096]</FR_DEP_NAME>\n   <NDSTMAIL />\n   <OWN_NUMBER />\n   <SEAL />\n   <SNDMETH_NAME>'+(1==e.params.p_sendmeth?"НАЗЕМНЫЙ":"АВИА")+"</SNDMETH_NAME>\n   <TO_DEP_NAME>Актау-1 [130001]</TO_DEP_NAME>\n   <TSFL />\n   <WGT_GR>000</WGT_GR>\n   <WGT_KG>"+e.params.p_weight+"</WGT_KG></CLIINFO>",UBAGBARCODE:"G201807180001235"}]}).onAny().reply(function(e){var t={trackid:"RB508027382SG",timestamp:"21:56:29 06.04.2018",direction:"IMPORT",status_code:"D",status:"Вручено",x_status_code:"S_ISS",x_status:"Вручено",sender:{country:"Сингапур",name:"1",address:"1",x_postindex:null},next:{bagNo:"00"+Math.floor(10*Math.random()),toIndex:0,x_dep_id:"19465",dep_name:"Сарыарка ГОПС 1",address:"Астана область, г. Астана, пр. Сарыарка, д.99",postindex:"010021"},origin:{date:"01.04.2018",x_dep_id:"18907",city:"Алматы",dep_name:"Участок по обработке международной почты г. Алматы",postindex:"220096"},receiver:{name:"Junnussov T",address:"Astana Saryarka  15",country:"Казахстан",x_postindex:null},last:{date:"05.04.2018",x_dep_id:"19465",city:"",dep_name:"Постамат пр. Сарыарка, д. 15, БЦ ИСКЕР",address:"Астана область, г. Астана, пр. Сарыарка, д.15",postindex:"900109"},delivery:{date:"05.04.2018",time:"15:41",period_fact:"4",x_period:null,x_dep_id:"19465",dep_name:"Постамат пр. Сарыарка, д. 15, БЦ ИСКЕР",address:"Астана область, г. Астана, пр. Сарыарка, д.15",postindex:"900104"},storage_period:"",package_type:"Мелкий пакет",category:"Заказное",delivery_method:"Авиа",dispute:"",weight:"менее 1"};return 100*Math.random()>10?[200,t]:[400,{error:"Отправление RB508027382SG не найдено!"}]}),ie=new se.a(B).onAny().reply(function(e){return console.log("led",e.params?e.params.led:e.params),[200,null]}),le=function(e){console.log("Populating"),e.settings.add({point:"000001",size:24,bindscan:1500,demoerror:!0,printer:"192.168.1.40",meta_:{updated:new Date},sortplan:{90001:"L1",90010:"L10",822133:"L101"},users:["SCNEVGENIYA","SCASTAGASIL","SCASTALZHANOVA","SCASTGALINA","SCASTGULMIRA","SCASTKALAMKAS","SCASTNAZIPA","SCASTDARYA","SCASTRAUSHAN","SCASTHASENOVA","SCASTGULZIFA","SCASTTLEYBAEVA"],bags:null,destinations:["00000","00001","00001","00002","00003","00004","00005","00006","00007","00008","00009","00010","00011","00012","00013","00014","00015","00016","00017","00018","00019","00020","00021","00022"]})},de={name:"app",data:function(){return{ui:{search:null,showModalLogin:!1}}},mixins:[q],mounted:function(){this.$bus.$on("keyboard:keydown:enter:13",this.barcodeSet),this.$bus.$on("keyboard:keydown:enter:i",this.registerDepcode),this.$bus.$on("keyboard:keydown:enter:u",this.auth),this.$ledoff()},created:function(){var e=this;this.$db.on("populate",function(){le(e.$db)}),this.toogleDemo(this.$store.state.polka.demo),this.toogleLed(this.$store.state.polka.ledOn)},beforeDestroy:function(){this.$bus.$off("keyboard:keydown:enter:13",this.barcodeSet),this.$bus.$off("keyboard:keydown:enter:i",this.registerDepcode),this.$bus.$off("keyboard:keydown:enter:u",this.auth)},computed:l()({},Object(d.c)({settings:"getSettingsSelected",setting:"getSettings",depcode:"getDepcode",autodepcode:"getAutoDepcode",ledOn:"getLedOn",demo:"getDemo",bags:"getBags",barcode:"getBarcode",hydrated:"hydrated",response:"getResponse",error:"getError"}),{online:function(){return this.$root.online},mqttOnline:function(){return this.$root.mqttOnline},user:{get:function(){return this.$store.state.polka.user},set:function(e){this.$store.state.polka.user=e}},depcode:{get:function(){return this.$store.state.polka.depcode},set:function(e){this.$store.state.polka.depcode=e}}}),watch:{hydrated:function(){this.settingsSelect(this.setting[0])},demo:function(e){localStorage.setItem("demo",e)},ledOn:function(e){localStorage.setItem("ledOn",e)},depcode:function(e){localStorage.setItem("depcode",e)},user:function(e){localStorage.setItem("user",e)}},methods:l()({},Object(d.b)(["settingsUpdate","settingsSelect"]),{barcodeSet:function(e){console.log("setting barcode",e),this.$store.state.polka.barcode=e},enterBarcodeManualy:function(e){console.log("enterBarcodeManualy",e),this.$bus.$emit("keyboard:keydown:enter:13",e)},enterBagManualy:function(e){console.log("enterBagManualy",e),this.$bus.$emit("keyboard:keydown:enter:p",e)},registerDepcode:function(e){this.settings.depcode=e,this.$store.state.polka.depcode=e,this.settingsUpdate(this.settings),console.log("registerdepcode",e)},auth:function(e){var t=this;V(e).then(function(n){console.log("auth",e),t.settings.user=e,t.$store.state.polka.user=e,t.settingsUpdate(t.settings)}).catch(function(){t.$error()})},toggleFullScreen:function(){document.fullScreenElement&&null!==document.fullScreenElement||!document.mozFullScreen&&!document.webkitIsFullScreen?document.documentElement.requestFullScreen?document.documentElement.requestFullScreen():document.documentElement.mozRequestFullScreen?document.documentElement.mozRequestFullScreen():document.documentElement.webkitRequestFullScreen&&document.documentElement.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT):document.cancelFullScreen?document.cancelFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen()},toogleDemo:function(e){this.$store.state.polka.demo=null!==e?e:!this.$store.state.polka.demo,this.demo&&re.restore()},toogleLed:function(e){this.$store.state.polka.ledOn=null==e?!this.$store.state.polka.ledOn:e,console.log("toogleLed",this.ledOn),this.ledOn&&ie.restore()}}),components:{Keyboard:p}},ce={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.hydrated?n("div",{attrs:{id:"app",Zclass:"{'bg-danger text-white':error,'bg-success text-white':response}"},on:{paste:function(t){e.enterBarcodeManualy(t.clipboardData.getData("text"))}}},[n("b-navbar",{staticClass:"bd-navbar",attrs:{toggleable:"md",fixed:"top",type:"dark"}},[n("b-nav-toggle",{attrs:{target:"nav_collapse"}}),n("b-navbar-brand",{attrs:{to:"/"}},[n("svg",{staticClass:"d-block",attrs:{width:"36",height:"36",viewBox:"0 0 612 612",xmlns:"http://www.w3.org/2000/svg",focusable:"false",fill:"#fff"}},[n("path",{attrs:{d:"M510,8 C561.846401,8.16468012 603.83532,50.1535995 604,102 L604,510 C603.83532,561.846401 561.846401,603.83532 510,604 L102,604 C50.1535995,603.83532 8.16468012,561.846401 8,510 L8,102 C8.16468012,50.1535995 50.1535995,8.16468012 102,8 L510,8 L510,8 Z M510,0 L102,0 C45.9,6.21724894e-15 0,45.9 0,102 L0,510 C0,566.1 45.9,612 102,612 L510,612 C566.1,612 612,566.1 612,510 L612,102 C612,45.9 566.1,6.21724894e-15 510,0 Z","fill-rule":"nonzero"}}),e._v(" "),n("text",{attrs:{id:"BV","font-family":"Arial","font-size":"350","font-weight":"light","letter-spacing":"2"}},[n("tspan",{attrs:{x:"72.0527344",y:"446"}},[e._v("B")]),e._v(" "),n("tspan",{attrs:{x:"307.5",y:"446"}},[e._v("V")])])])]),n("b-navbar-brand",{on:{click:function(t){e.toggleFullScreen()}}},[e._v("Sortrack® "+e._s(e.$store.state.user))]),e.user?n("b-collapse",{attrs:{"is-nav":"",id:"nav_collapse"}},[n("b-navbar-nav",[n("b-nav-item",{attrs:{to:"/console2"}},[e._v("Консоль")]),n("b-nav-item",{attrs:{to:"/admin"}},[e._v("Настройки")]),n("b-nav-item",{on:{click:function(t){e.toogleDemo(null)}}},[n("toggle-button",{attrs:{value:e.demo,sync:!0,labels:{checked:"Prod",unchecked:"Demo"}}})],1),n("b-nav-item",{on:{click:function(t){e.toogleLed()}}},[n("toggle-button",{attrs:{value:e.ledOn,sync:!0,labels:{checked:"LED",unchecked:"LED"}}})],1)],1),n("b-navbar-nav",{staticClass:"ml-auto"},[n("b-nav-form",[n("b-form-input",{staticClass:"mr-sm-2",staticStyle:{width:"5rem"},attrs:{size:"sm",placeholder:"Мешок"},nativeOn:{focus:function(e){e.target.value=""},dblclick:function(t){e.enterBagManualy},keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.enterBagManualy(t.target.value)}}})],1),n("b-nav-form",[n("b-form-input",{staticClass:"mr-sm-2",attrs:{size:"sm",placeholder:e.barcode?e.barcode:"Поис поссылок  ..."},nativeOn:{focus:function(e){e.target.value=""},dblclick:function(t){e.enterBarcodeManualy("KZ"+Math.floor(1e9*Math.random())+"KZ"),t.target.value="",t.target.blur()},keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;t.stopPropagation(),e.enterBarcodeManualy(t.target.value),t.target.value="",t.target.blur()}}})],1),e.settings?n("b-nav-item",{directives:[{name:"b-modal",rawName:"v-b-modal.depcode",modifiers:{depcode:!0}}],attrs:{right:""}},[e.depcode?n("span",[e._v(e._s(e.depcode))]):n("span",{staticClass:"text-muted"},[e._v("["+e._s(e.autodepcode)+"]")])]):e._e(),n("b-nav-item",{directives:[{name:"b-modal",rawName:"v-b-modal.user",modifiers:{user:!0}}],attrs:{right:""}},[e._v(e._s(e.user)+" ")])],1)],1):n("b-navbar-nav",{staticClass:"ml-auto"},[n("b-nav-item",{directives:[{name:"b-modal",rawName:"v-b-modal.user",modifiers:{user:!0}}],attrs:{right:""}},[e._v("Log In")])],1)],1),n("b-container",{attrs:{fluid:""}},[n("router-view")],1),n("Keyboard"),n("b-modal",{attrs:{id:"depcode",title:"Код департамента","ok-title":"Изменить","hide-footer":!0}},[n("b-form-input",{attrs:{palceholder:"Depcode"},model:{value:e.depcode,callback:function(t){e.depcode=t},expression:"depcode"}})],1),n("b-modal",{attrs:{id:"user",title:"CPILS Пользователь","ok-title":"Войти","hide-footer":!0}},[n("b-form-input",{attrs:{palceholder:"CPILS Login"},model:{value:e.user,callback:function(t){e.user=t},expression:"user"}})],1)],1):e._e()},staticRenderFns:[]};var ue=n("VU/8")(de,ce,!1,function(e){n("eUDQ"),n("wEtC")},null,null).exports,pe=n("nkUn"),ge=n.n(pe),be=n("e6fC"),he={install:function(e){Object.defineProperty(e.prototype,"$http",{value:y.a})}},fe=n("/ocq"),me=n("BO1k"),ve=n.n(me),_e=n("Gu7T"),ye=n.n(_e),ke={name:"Console",mounted:function(){this.$bus.$on("keyboard:keydown:enter:13",this.putToBag),this.$bus.$on("keyboard:keydown:enter:d",this.closeBag),this.$bus.$on("keyboard:keydown:enter:p",this.closeBag),this.$ledoff()},created:function(){this.bagCounts=[].concat(ye()(new Array(this.settings.destinations.length))).map(function(e){return 0})},beforeDestroy:function(){this.$ledoff(),this.$bus.$off("keyboard:keydown:enter:13",this.putToBag),this.$bus.$off("keyboard:keydown:enter:d",this.closeBag),this.$bus.$off("keyboard:keydown:enter:p",this.closeBag)},computed:l()({},Object(d.c)({settings:"getSettingsSelected"}),{demo:function(){return this.$root.demo}}),data:function(){return{status:null,formInput:null,tmResponse:null,response:null,barcode:null,toIndex:null,isClosedBag:null,toLed:null,user:"r",showBagInfo:null,bagCounts:[],bagBarcodes:{}}},mixins:[q],watch:{response:function(e){e&&(window.clearTimeout(this.tmResponse),this.tmResponse=window.setTimeout(this.clear,1e4))},isClosedBag:function(e){var t=this;e&&window.setTimeout(function(){t.isClosedBag=null},5e3)}},methods:l()({},Object(d.b)(["settingsUpdate"]),{putToBag:function(e){var t=this;if(this.barcode=e.toUpperCase(),this.clear(),this.bagBarcodes[this.barcode]){this.status="pull",console.log("pullFromBag barcode",this.barcode),this.toIndex=this.bagBarcodes[this.barcode],this.toLed=this._getLeds(this.toIndex);var n=!0,o=!1,s=void 0;try{for(var a,i=ve()(this.toLed);!(n=(a=i.next()).done);n=!0){var l=a.value;r.default.set(this.bagCounts,l,this.bagCounts[l]-1)}}catch(e){o=!0,s=e}finally{try{!n&&i.return&&i.return()}finally{if(o)throw s}}return this.$pull(this.user,this.toLed.toString()),void r.default.delete(this.bagBarcodes,this.barcode)}console.log("putToBag barcode",this.barcode),this.status="search",this.$search(),Y(this.barcode).then(function(e){if(t.response=e.data,t.demo&&(10*Math.random()<9?(t.response.next.bagNo="L"+Math.floor(Math.random()*t.settings.maxLeds),t.response.next.toIndex="0000"+Math.floor(Math.random()*t.settings.maxLeds),console.log("demo",t.settings.maxLeds)):(t.response.next.bagNo="S",t.response.next.toIndex="00099")),null!==t.response.next&&null!==t.response.next.bagNo)if(t.toIndex=t.response.next.toIndex,t.toLed=t._getLeds(t.toIndex),t.toLed.length>0){t.$push(t.user,t.toLed.toString()),r.default.set(t.bagBarcodes,t.barcode,t.toIndex),console.log("bagBarcodes",t.bagBarcodes),t.status="found";var n=!0,o=!1,s=void 0;try{for(var a,i=ve()(t.toLed);!(n=(a=i.next()).done);n=!0){var l=a.value;r.default.set(t.bagCounts,l,t.bagCounts[l]+1)}}catch(e){o=!0,s=e}finally{try{!n&&i.return&&i.return()}finally{if(o)throw s}}}else t.status="notbind",console.error("Полки не настроены!"),t.response={error:"Направление "+t.toIndex+" не привязано к мешку "},t.$notBind();else t.status="notfoundnextplan",console.error("Нет плана!"),t.response={error:"Отправление "+t.barcode+" не привязано к плану "},t.$notPlan()}).catch(function(e){t.status="notfound",console.error("ШПИ не найден",e.response.data),t.response=e.response?e.response.data:{error:"catch"},t.$notFound()})},_getLeds:function(e){return this.settings.destinations.reduce(function(t,n,o){return n===e&&t.push(o),t},[])},bagBarcodesInsideBag:function(e){return console.log("bagBarcodesInsideBag",e),f()(this.bagBarcodes).reduce(function(t,n,o){return n[1]===e&&t.push(n[0]),t},[])},showBag:function(e,t){console.log("showBag",e,t,this.bagBarcodes),this.showBagInfo={leds:e,toIndex:t},this.$refs.myModalRef.show()},closeBag:function(e){var t=this;this.toIndex=e,this.toLed=this._getLeds(this.toIndex);var n={bag:e,count:this.bagCounts[this.toLed[0]]};H(n).then(function(o){console.log("closeBag",t.toLed,e),t.isClosedBag=e,t.$closeBag(t.toLed.toString()),t.$printBag(n.count),t.bagBarcodes=f()(t.bagBarcodes).reduce(function(t,n,o){return console.log(),n[1]!==e&&(t[n[0]]=n[1]),t},{});var s=!0,a=!1,i=void 0;try{for(var l,d=ve()(t.toLed);!(s=(l=d.next()).done);s=!0){var c=l.value;r.default.set(t.bagCounts,c,0)}}catch(e){a=!0,i=e}finally{try{!s&&d.return&&d.return()}finally{if(a)throw i}}}).catch(function(e){console.log("error",e),t.response=e.response?e.response.data:{error:"catch"},t.$error()})},demobarcode:function(){10*Math.random()<9?this.$bus.$emit("keyboard:keydown:enter:13","KZ"+Math.floor(1e9*Math.random())+"KZ"):this.$bus.$emit("keyboard:keydown:enter:13","KZ111111111KZ")},clear:function(){this.response=null,this.toIndex=null,this.toLed=null,this.status=null}})},xe={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("b-row",{staticClass:"flex-xl-nowrap2"},[n("div",{staticClass:"pl-md-5 bd-content col-12"},[n("h2",{staticClass:"mb-2",on:{click:e.$ledoff}},[e._v("Сортировка")]),n("b-card-group",{staticClass:"polkas",attrs:{deck:"deck"}},e._l(e.settings.destinations,function(t,o){return n("b-card",{key:o,class:{closed:t==e.isClosedBag},attrs:{"bg-variant":e.toIndex==t?"danger":"","text-variant":e.toIndex==t?"white":"","no-body":"no-body",align:"center"},on:{click:function(n){e.showBag(o,t)}}},[n("b-card-header",[e._v(e._s(t?""+t:"Пусто")),e.bagCounts[o]?n("b-btn",{staticClass:"close",on:{click:function(n){n.stopPropagation(),e.closeBag(t)}}},[e._v("×")]):e._e()],1),n("b-card-body",[n("h4",{staticClass:"card-title"},[e._v(e._s(o+1))])]),e.bagCounts[o]?n("div",{staticClass:"stat"},[e._v(e._s(e.bagCounts[o]))]):e._e()],1)})),n("hr"),n("b-card",{attrs:{"no-body":"no-body","bg-variant":e.response&&e.response.error?"danger":"","text-variant":e.response&&e.response.error?"white":""}},[n("b-card-header",{on:{click:function(t){e.demobarcode()}}},[e._v("Поиск ШПИ "),n("b",[e._v(e._s(e.barcode)+" ")]),n("b-btn",{staticClass:"close",on:{click:function(t){t.stopPropagation(),e.putToBag(e.barcode)}}},[e._v(" ×")]),"search"==e.status?n("b-progress",{attrs:{value:100,max:100,striped:"striped",animated:"animated"}}):e._e()],1),e.response?n("b-card-body",[e.response.error?n("p",[e._v(e._s(e.response.error))]):[n("h4",{staticClass:"card-title"},[e._v(e._s(e.toIndex)+" положить в полку "+e._s(e.toLed))]),n("p",[e._v("Следующий пункт : "+e._s(e.response.next.dep_name))]),n("blockquote",{staticClass:"blockquote-footer"},[e._v(e._s(e.response.delivery.dep_name)+" - "+e._s(e.response.delivery.address))])]],2):e._e()],1)],1),n("b-modal",{ref:"myModalRef",attrs:{"no-fade":"no-fade","header-bg-variant":"primary","header-text-variant":"white","ok-title":"Закрыть мешок","cancel-title":"Отмена"},on:{close:function(t){e.showBagInfo=null},ok:function(t){e.closeBag(e.showBagInfo.toIndex)}}},[null!==e.showBagInfo?n("template",{slot:"modal-title"},[e._v("Полка "+e._s(e.showBagInfo.leds)+" - "+e._s(e.bagCounts[e.showBagInfo.leds])+" шт - Индекс "+e._s(e.showBagInfo.toIndex))]):e._e(),null!==e.showBagInfo?[n("h4",[e._v("ШПИ ")]),n("table",{staticClass:"table b-table mt-4"},e._l(e.bagBarcodesInsideBag(e.showBagInfo.toIndex),function(t,o){return n("tr",[n("td",[e._v(e._s(t))])])}))]:e._e()],2)],1)},staticRenderFns:[]};var we=n("VU/8")(ke,xe,!1,function(e){n("1IkK")},"data-v-261a4ea4",null).exports,Be=n("bOdI"),$e=n.n(Be),Ce=n("oT2G"),Se=new(n.n(Ce).a),Ae={name:"SortplanModal",computed:l()({},Object(d.c)({sortplan:"getSortplan",depcodeDefault:"getAutoDepcode",config:"config"}),{depcode:function(){return this.depcodeManual?this.depcodeManual:this.depcodeDefault}}),created:function(){this.fetch(this.depcodeDefault)},data:function(){return{depcodeManual:null,status:null,error:null}},methods:l()({},Object(d.b)(["$fillBags","$fetchSortplan"]),{encode:function(e){return Se.encode(e)},fetch:function(e){var t=this;this.status="loading",this.error=null,this.$fetchSortplan({depcode:e}).then(function(e){t.status=e}).catch(function(e){t.error=e})},print:function(){window.print()}})},Ie={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("b-modal",{ref:"msortplan",attrs:{id:"msortplan",title:"Сортплан",size:"lg","hide-footer":"hide-footer"}},[n("template",{slot:"modal-header"},[n("b-form-group",{staticClass:"mx-4 mt-3"},[n("b-input-group",{attrs:{size:"lg"}},[n("b-input-group-text",{attrs:{slot:"prepend"},slot:"prepend"},[e.sortplan?[e._v(e._s(Object.keys(e.sortplan.plan).length)+"шт")]:e._e()],2),n("b-form-input",{attrs:{id:"inputPlan",state:null==e.error&&null,placeholder:"Код продразделения "+e.depcodeDefault},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.fetch(e.depcode)}},model:{value:e.depcodeManual,callback:function(t){e.depcodeManual=t},expression:"depcodeManual"}}),n("b-input-group-append",[n("b-btn",{attrs:{variant:"primary"},on:{click:function(t){e.$fillBags({plan:e.sortplan.plan})}}},[e._v("Загрузить")]),n("b-btn",{on:{click:function(t){e.print()}}},[e._v("Печать")])],1),n("b-form-invalid-feedback",{attrs:{id:"inputPlan"}},[e._v(e._s(e.error?e.error.message:null))])],1)],1)],1),e.sortplan?n("div",{staticClass:"mx-4 mb-4",attrs:{id:"printSection"}},[n("h4",[e._v("Сортплан "+e._s(e.depcode))]),n("b-card-group",{staticClass:"sortplan",attrs:{deck:"deck"}},e._l(Object.entries(e.sortplan.plan),function(t){return n("b-card",{key:t[0],attrs:{align:"center","no-body":"no-body"}},[n("template",{slot:"header"},[t[0]!=t[1]?n("span",[e._v(e._s(t[1])+" ")]):e._e(),n("b",[e._v(e._s(t[0]))])]),n("div",{staticClass:"barcode"},[e._v(e._s(e.encode("p"+t[0])))])],2)})),n("h4",[e._v("Пользователи")]),e.config&&e.config.users?n("b-card-group",{staticClass:"users",attrs:{deck:"deck"}},e._l(e.config.users,function(t){return n("b-card",{key:t,attrs:{align:"center","no-body":"no-body"}},[n("template",{slot:"header"},[n("b",[e._v(e._s(t))])]),n("div",{staticClass:"barcode"},[e._v(e._s(e.encode("u"+t)))])],2)})):e._e()],1):e._e()],2)},staticRenderFns:[]};var Te=n("VU/8")(Ae,Ie,!1,function(e){n("QODJ"),n("iDF2")},null,null).exports,Ee={methods:{wizardToggle:function(){console.log("wizardToggle"),this.bind.started?(this.bind.started=!1,this.bind.cursor=null,this.bind.unmappedIndx=null,window.clearInterval(this.bind.intrvl),this.$deselectBag()):(this.bind.started=!0,this.wizardNext())},wizardNext:function(e){var t=this;console.log("wizardNext",this.bind.cursor,e),e&&this.$remapSelectedBag({bagno:e,led:this.bind.unmappedIndx}),this.bags.length>this.bind.cursor+1?(null==this.bind.cursor?this.bind.cursor=0:this.bind.cursor++,this.$deselectBag(),window.setTimeout(function(){t.$selectBag({bagno:t.bags[t.bind.cursor].no})},200),window.clearInterval(this.bind.intrvl),this.calcUnmappedLeds(),this.bind.intrvl=window.setInterval(this.scanLeds,this.settings.bindscan||1500)):this.wizardToggle()},calcUnmappedLeds:function(){var e=this;this.bind.unmapped=this.bags.reduce(function(e,t,n){return null===t.led&&e.push(n),e},[]),0==this.bind.unmapped.length&&confirm("All LEDs already calibrated, confirm reset?")&&(f()(this.bags).forEach(function(t,n){r.default.set(e.bags[n],"led",null)}),console.log("bags reseted",this.bags)),this.bind.unmappedIndx=-1},scanLeds:function(){this.bags.length-1==this.bind.unmappedIndx?this.bind.unmappedIndx=0:this.bind.unmappedIndx++,ee.on("bind",this.bind.unmappedIndx)}}},Me=n("q7Xt"),Le=n.n(Me),Re={name:"CloseModal",props:["isCloseModalOpen"],mounted:function(){this.$bus.$on("keyboard:keydown:enter:p",this.next)},beforeDestroy:function(){this.$bus.$off("keyboard:keydown:enter:p",this.next)},computed:l()({},Object(d.c)({response:"getCloseResponse",selected:"getSelected",selectedBag:"getSelectedBag",meta:"bagMetaData",bags:"getBags"})),data:function(){return{tabIndex:0,weight:0,sendmeth:1}},methods:l()({},Object(d.b)(["$closeBag","$clear","$deselectBag","$saveConfig"]),{closeBag:function(){var e=this;this.$closeBag({bagno:this.selected,weight:this.weight,depcode:this.selectedBag.index,sendmeth:this.sendmeth}).then(function(){e.tabIndex=2,e.print()})},next:function(e){e==this.selected&&this.meta?0==this.tabIndex?this.tabIndex=1:1==this.tabIndex?this.closeBag():2==this.tabIndex&&this.clear():this.clear()},clear:function(){this.$deselectBag(),this.$emit("close")},print:function(){var e=document.getElementById("bagPrintData").innerText;e=(e=Le()().transform(e)).replace("қ","k"),ee.printbag(e)},printTest:function(){ee.printbagTest(),this.clear()}})},De={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("b-modal",{ref:"closeModalRef",attrs:{id:"mclosebag","no-enforce-focus":"no-enforce-focus",size:"lg","no-fade":"no-fade",visible:"visible"},on:{hide:e.clear}},[e.meta&&e.meta.next.bag?n("template",{slot:"modal-header"},[n("b-link",{staticClass:"close",on:{click:function(t){return t.stopPropagation(),e.clear(t)}}},[e._v(" ×")]),n("h3",[e._v("Мешок "+e._s(e.meta.next.bagNo)+" - "+e._s(e.meta.next.bag.barcode)+" - "+e._s(e.selectedBag.index))]),n("div",{staticClass:"meta"},[n("small",[e._v(e._s(e.meta.next.bag.created)+" "+e._s(e.meta.next.bag.user))]),n("small",{staticClass:"pull-right ml-2"},[e._v("BID : "+e._s(e.meta.next.bag.bid)+" DEPID : "+e._s(e.meta.next.bag.bdepid))])])],1):n("template",{slot:"modal-header"},[n("h2",{staticClass:"modal-title text-primary"},[e._v("Мешок "+e._s(e.selected)+" - "+e._s(e.selectedBag.index))])]),n("b-card",{attrs:{"no-body":"no-body"}},[n("b-tabs",{staticClass:"nav-justified wizard",attrs:{pills:"pills",card:"card"},model:{value:e.tabIndex,callback:function(t){e.tabIndex=t},expression:"tabIndex"}},[n("b-tab",[n("template",{slot:"title"},[n("span",{directives:[{name:"b-toggle",rawName:"v-b-toggle",value:"settings_collapse",expression:"'settings_collapse'"}]},[e._v("Содержимое ")]),e.meta?n("span",[e._v(e._s(e.meta.addDetailPREGMAIL.mlcntq)+" шт")]):e._e()]),n("table",{staticClass:"table b-table"},[n("tr",[n("th",[e._v("#")]),n("th",[e._v("ШПИ")]),n("th",[e._v("КУДА Индекс ")]),n("th",[e._v("DEPID / Кол-во / Вес")])]),e._l(e.selectedBag.wpi,function(t,o){return n("tr",[n("td",[n("i",{staticClass:"fa-icon fa-star"})]),n("td",{attrs:{title:JSON.stringify(t)}},[e._v(e._s(o))]),n("td",[e._v(e._s(t.toIndex))]),n("td",[e._v(e._s(t.p_depcode)+" | "+e._s(t.addDetailPREGMAIL.mlcntq)+" | "+e._s(t.addDetailPREGMAIL.wghtv))])])})],2)],2),n("b-tab",{attrs:{title:"Вес и Вид"}},[n("b-form-group",{attrs:{label:"Итоговый Вес",horizontal:"horizontal"}},[n("b-input-group",[n("b-form-input",{attrs:{type:"number",size:"lg",required:"required",palceholder:"Вес"},model:{value:e.weight,callback:function(t){e.weight=t},expression:"weight"}}),n("b-input-group-append",[n("b-btn",{attrs:{variant:"white"},on:{click:function(t){e.weight=1.5}}},[e._v("Считать вес")])],1)],1)],1),n("b-form-group",{attrs:{label:"Вид отправки",horizontal:"horizontal"}},[1==e.sendmeth?n("b-btn",{on:{click:function(t){e.sendmeth=2}}},[e._v("Наземный")]):n("b-btn",{attrs:{variant:"primary"},on:{click:function(t){e.sendmeth=1}}},[e._v("Авия")])],1)],1),n("b-tab",{attrs:{title:"Ярлык",disabled:!(e.response&&e.response.cli_info)}},[e.response&&e.response.cli_info?n("code",{staticClass:"text-primary"},[n("div",{staticClass:"mx-4"},[n("code",{staticClass:"hide",attrs:{id:"bagPrintData"}},[e._v('N\nq720\nj555\nl8,C,001\nX0,40,4,710,640\n \nA20,60,0,5,1,1,N,"'+e._s(e.response.cli_info.BAGTYPE_NAME)+'"\nA20,120,0,4,1,1,N,"KYDA"\nA300,120,0,4,1,1,N,"'+e._s(e.response.cli_info.TO_DEP_NAME)+'"\n \nA20,150,0,4,1,1,N,"OT"\nA300,150,0,4,1,1,N,"'+e._s(e.response.cli_info.FR_DEP_NAME)+'"\n \nA20,180,0,4,1,1,N,"BEC '+e._s(e.response.cli_info.WGT_KG)+'"\nA300,180,0,4,1,1,N,"'+e._s(e.response.cli_info.WGT_GR)+' gr"\n \nA20,210,0,4,1,1,N,""\n \nB20,240,0,1,2,2,100,B,"'+e._s(e.response.cli_info.BARCODE)+'"\n \nA20,480,0,4,1,1,N,"COTPYDHNK"\nA300,480,0,4,1,1,N,"'+e._s(e.response.closeBag.p_cpilslogin)+'"\nA380,480,0,4,1,1,N,"_______________"\n \nA20,510,0,1,1,1,N,"© 2018 Powered by SORTRACK®, KAZPOST INC"\nP1\nN')]),n("div",[n("b",[e._v("ШТРИХКОД ")]),n("span",[e._v(e._s(e.response.cli_info.BARCODE))])]),n("div",[n("b",[e._v("МЕТОД ")]),n("span",[e._v(e._s(e.response.cli_info.SNDMETH_NAME))])]),n("div",[n("b",[e._v("ТИП ")]),n("span",[e._v(e._s(e.response.cli_info.BAGTYPE_NAME))])]),n("div",[n("b",[e._v("ОТ ")]),n("span",[e._v(e._s(e.response.cli_info.FR_DEP_NAME))])]),n("div",[n("b",[e._v("КУДА ")]),n("span",[e._v(e._s(e.response.cli_info.TO_DEP_NAME))])]),n("div",[n("b",[e._v("ВЕС ")]),n("span",[e._v(e._s(e.response.cli_info.WGT_KG)+" ")]),n("span",[e._v(e._s(e.response.cli_info.WGT_GR))])]),n("div",[n("b",[e._v("ОПЕРАТОР ")]),n("span",[e._v(e._s(e.response.closeBag.p_cpilslogin))])]),n("div",[n("b",[e._v("ИНДЕКС ОПЕРАТОРА ")]),n("span",[e._v(e._s(e.response.closeBag.bag.todepindex))])])])]):e._e(),e.response&&e.response.error?n("code",{staticClass:"text-danger"},[e._v(" "+e._s(e.response))]):e._e(),2==e.tabIndex&&e.response?n("div",{staticClass:"text-center"},[n("b-btn",{attrs:{variant:"primary"},on:{click:e.print}},[e._v("Печать")])],1):e._e()])],1)],1),e.selectedBag?n("b-collapse",{attrs:{"is-nav":"is-nav",id:"settings_collapse"}},[n("b-form",{staticClass:"my-3"},[n("b-form-group",{attrs:{horizontal:"horizontal",label:"LED"}},[n("b-form-input",{model:{value:e.selectedBag.led,callback:function(t){e.$set(e.selectedBag,"led",t)},expression:"selectedBag.led"}})],1),n("b-form-group",{attrs:{horizontal:"horizontal"}},[n("b-btn",{on:{click:e.$saveConfig}},[e._v("Save")])],1)],1)],1):e._e(),n("template",{slot:"modal-footer"},[n("b-link",{attrs:{size:"sm"},on:{click:function(t){e.$bus.$emit("keyboard:keydown:enter:p",e.selected)}}},[e._v("Scan Selected | ")]),n("b-link",{attrs:{size:"sm"},on:{click:function(t){e.$bus.$emit("keyboard:keydown:enter:p",Object.keys(e.bags)[1])}}},[e._v("Scan Bag 2")]),1!=e.tabIndex||e.response?e._e():n("b-btn",{attrs:{variant:"primary"},on:{click:e.closeBag}},[e._v("Закрыть мешок")])],1)],2)},staticRenderFns:[]};var ze,Ne=n("VU/8")(Re,De,!1,function(e){n("PuYh")},null,null).exports,Oe=(ze={name:"Console2",mounted:function(){this.$bus.$on("keyboard:keydown:enter:13",this.putToBag),this.$bus.$on("keyboard:keydown:enter:p",this.selectBag)},beforeDestroy:function(){this.$bus.$off("keyboard:keydown:enter:13",this.putToBag),this.$bus.$off("keyboard:keydown:enter:p",this.selectBag)},created:function(){ee.$ledoff()},watch:{status:function(e){e&&(console.log("sound",e),this.selectedBag&&this.selectedBag.led?(console.log("LED",this.selectedBag.led),ee.on(e,this.selectedBag.led)):this.cursor&&ee.on(e,this.cursor),Q.play(e))}},data:function(){return{tmResponse:null,isCloseModalOpen:!1,kazakhstan:!1,bind:{started:!1,cursor:null,unmappedIndx:null,unmapped:[],intrvl:null}}},computed:l()({},Object(d.c)({settings:"getSettingsSelected",bags:"getBags",config:"getConfig",status:"getStatus",barcode:"getBarcode",response:"getResponse",error:"getError",cursor:"cursor",selected:"getSelected",selectedBag:"getSelectedBag"})),mixins:[Ee]},$e()(ze,"created",function(){this.bags||this.$initBags()}),$e()(ze,"methods",l()({},Object(d.b)(["$initBags","$putToBag","$selectBag","$deselectBag","$remapSelectedBag","$clear","$saveConfig"]),{timeout:function(e){window.clearTimeout(this.tmResponse),this.tmResponse=window.setTimeout(this.$clear,e)},selectBag:function(e){var t=this;console.log("selectBag",e),this.isCloseModalOpen||(this.bind.started?(console.log("Binding",e),this.wizardNext(e)):(window.clearTimeout(this.tmResponse),this.$clear(),this.$selectBag({bagno:e}).then(function(){t.isCloseModalOpen=!0}).catch(function(e){console.error("selectBag error",e),t.timeout(5e3)})))},putToBag:function(e){var t=this;e=e.toUpperCase().trim(),console.log("putToBag barcode",e),this.$putToBag({barcode:e}).then(function(e){t.timeout(1e4),console.log("Положили в корзину",e)}).catch(function(e){console.error("putToBag error",e),t.timeout(5e3)})},clearAll:function(){this.$clear(),ee.$ledoff()}})),$e()(ze,"components",{SortplanModal:Te,CloseModal:Ne}),ze),Pe={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("b-row",{staticClass:"flex-xl-nowrap2"},[n("div",{staticClass:"pl-md-5 pt-2 mt-4 bd-content col-12"},[n("b-card-group",{staticClass:"polkas",attrs:{deck:"deck"}},e._l(e.bags,function(t,o){return n("b-card",{key:o,class:{"text-muted":!Object.keys(t)[0],outlined:e.bind.unmappedIndx==o},attrs:{"no-body":"no-body",align:"center","bg-variant":e.selected==t.no?"success":"","text-variant":e.selected==t.no?"white":""},on:{click:function(n){e.selectBag(t.no)}}},[n("b-card-header",[e._v(e._s(t.no)),t.no!=t.index?n("small",{staticClass:"text-muted indx"},[n("span",{staticClass:"led",class:{remapped:null!=t.led}},[e._v(e._s(t.led?t.led:o))])]):e._e(),Object.keys(t.wpi).length?n("b-btn",{staticClass:"close"},[e._v("×")]):e._e()],1),n("b-card-body",[n("h4",{staticClass:"card-title"},[e._v(e._s(Object.keys(t.wpi).length))])])],1)})),n("b-collapse",{attrs:{id:"collapse1_inner"}},[n("code",[e._v(e._s(this.bind.unmapped))]),n("hr"),n("code",[e._v(e._s(e.bags))])])],1),n("div",{staticClass:"m-4 p-2 fixed-bottom"},[n("b-card",{attrs:{"no-body":"no-body","bg-variant":e.error?"danger":"","text-variant":e.error?"white":""}},[n("b-card-header",[e._v("ШПИ "),n("b",[e._v(e._s(e.barcode)+" ")]),e.response?n("span",[e._v("конечный индекс "+e._s(e.response.toIndex))]):e._e(),n("b-btn",{staticClass:"close",on:{click:function(t){return t.stopPropagation(),e.clearAll(t)}}},[e._v(" ×")]),n("div",{staticClass:"debug float-right mr-3"},[n("b-link",{directives:[{name:"b-toggle",rawName:"v-b-toggle",value:"collapse1_inner",expression:"'collapse1_inner'"}]},[e._v("Debug 2.2 | ")]),n("b-link",{directives:[{name:"b-modal",rawName:"v-b-modal",value:"msortplan",expression:"'msortplan'"}]},[e._v("Сортплан | ")]),n("b-link",{class:{"bg-primary text-white":e.bind.started},attrs:{size:"sm"},on:{click:e.wizardToggle}},[e._v(e._s(e.bind.started?"Bind Stop":"Bind Start"))])],1),"search"==e.status?n("b-progress",{attrs:{value:100,max:100,striped:"striped",animated:"animated"}}):e._e()],1),n("b-card-body",[e.error?n("p",[e._v(e._s(e.error))]):e._e(),e.response?[n("h4",{staticClass:"card-title"},[e._v("Мешок "+e._s(e.response.next.bagNo)+" "),e.response.next.bagIndex!=e.response.next.bagNo?n("span",[e._v("- Опорный Индекс "+e._s(e.response.next.bagIndex))]):e._e()]),e._v("Кол-во : "),n("b",[e._v(e._s(e.response.addDetailPREGMAIL.mlcntq)+" ")]),e._v("Вес: "),n("b",[e._v(e._s(e.response.addDetailPREGMAIL.wghtv))]),n("span",{staticClass:"text-muted ml-5"},[e._v(e._s(e.response.next.bag.created)+"  - ")]),e._v(e._s(e.response.next.bag.user)+" \n( "+e._s(e.response.p_depcode)+" )       ")]:e._e()],2)],1)],1),e.isCloseModalOpen?n("CloseModal",{on:{close:function(t){e.isCloseModalOpen=!1}}}):e._e(),n("SortplanModal")],1)},staticRenderFns:[]};var Ue=n("VU/8")(Oe,Pe,!1,function(e){n("0BqW")},"data-v-01166d5a",null).exports,Ge={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("b-row",{staticClass:"flex-xl-nowrap2"},[n("b-col",{staticClass:"bd-sidebar",attrs:{md:"3",xl:"2",cols:"12"}},[n("div",{staticClass:"bd-search d-flex align-items-center"},[n("b-form-input",{directives:[{name:"focus",rawName:"v-focus"}],attrs:{id:"bd-search-input",placeholder:"Поиск посылок ..."},model:{value:e.barcode,callback:function(t){e.barcode=t},expression:"barcode"}})],1),n("nav",{staticClass:"bd-links navbar-collapse",attrs:{id:"bd-docs-nav"}},[n("div",{staticClass:"bd-toc-item"},[n("a",{staticClass:"bd-toc-link",attrs:{disabled:"disabled",href:"/admin/settings"}},[e._v("Статистика")]),n("ul",{staticClass:"bd-sidenav nav"})]),n("div",{staticClass:"bd-toc-item active"},[n("b-link",{staticClass:"bd-toc-link",attrs:{to:"/admin/sortplan"}},[e._v("Сортплан")])],1),n("div",{staticClass:"bd-toc-item"},[n("b-link",{staticClass:"bd-toc-link",attrs:{to:"/admin/settings"}},[e._v("Настройки")])],1),n("div",{staticClass:"bd-toc-item"},[n("b-link",{staticClass:"bd-toc-link",attrs:{to:"/admin/debug"}},[e._v("Debug")])],1)])]),n("div",{staticClass:"pt-4 pb-md-3 pl-md-5 bd-content col-md-9 col-xl-8 col-12"},[n("router-view")],1)],1)},staticRenderFns:[]};var We=n("VU/8")({name:"Admin",mounted:function(){this.$bus.$on("keyboard:keydown:enter:13",this.barcodeToggle)},beforeDestroy:function(){this.$bus.$off("keyboard:keydown:enter:13",this.barcodeToggle)},data:function(){return{barcode:""}},methods:{barcodeToggle:function(e){this.barcode=e}}},Ge,!1,function(e){n("EpXN")},"data-v-27b7d9a8",null).exports,Fe={name:"Settings",mixins:[q],mounted:function(){this.deviceip=x,this.apiUrl=k},data:function(){return{deviceip:null,apiUrl:null}},computed:l()({},Object(d.c)({settings:"getSettingsSelected"})),methods:l()({},Object(d.b)(["settingsUpdate","$initBags"]),{saveSettings:function(){var e=this;localStorage.setItem("deviceip",this.deviceip),localStorage.setItem("apiUrl",this.apiUrl),this.settings.deviceip=this.deviceip,this.settings.apiUrl=this.apiUrl,this.$initBags().then(function(){console.log("settgins updated"),e.settingsUpdate(e.settings)}),location.reload()},publishOn:function(){this.$ledOn(this.cmd),console.log("publish",this.cmd)},toggleUser:function(){this.$bus.$emit("keyboard:keydown:enter:u",["ASEM","TIMUR","NATALYA"][Math.floor(3*Math.random())])},togglePoint:function(){this.$bus.$emit("keyboard:keydown:enter:i",["220081","320080"][Math.floor(2*Math.random())])},testPrint:function(){}})},Ke={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"row"},[n("div",{staticClass:"col-12"},[n("h1",[e._v("Настройки")]),n("b-form",{staticClass:"mt-3"},[n("b-form-group",{attrs:{label:"Кол-во LED",horizontal:"horizontal"}},[n("b-form-input",{model:{value:e.settings.size,callback:function(t){e.$set(e.settings,"size",t)},expression:"settings.size"}})],1),n("b-form-group",{attrs:{label:"Bind Scan",horizontal:"horizontal"}},[n("b-form-input",{model:{value:e.settings.bindscan,callback:function(t){e.$set(e.settings,"bindscan",t)},expression:"settings.bindscan"}})],1),n("b-form-group",{attrs:{label:"Error Simulate",horizontal:"horizontal"}},[n("b-form-checkbox",{model:{value:e.settings.demoerror,callback:function(t){e.$set(e.settings,"demoerror",t)},expression:"settings.demoerror"}})],1),n("b-form-group",{attrs:{label:"IP Device",horizontal:"horizontal"}},[n("b-form-input",{model:{value:e.deviceip,callback:function(t){e.deviceip=t},expression:"deviceip"}})],1),n("b-form-group",{attrs:{label:"URL Сервиса",horizontal:"horizontal"}},[n("b-form-input",{model:{value:e.apiUrl,callback:function(t){e.apiUrl=t},expression:"apiUrl"}})],1),n("b-form-group",{attrs:{label:"User",horizontal:"horizontal"}},[n("b-btn",{on:{click:e.toggleUser}},[e._v("Toggle User")])],1),n("b-form-group",{attrs:{label:"Point",horizontal:"horizontal"}},[n("b-btn",{on:{click:e.togglePoint}},[e._v("Toggle Point")])],1),n("b-form-group",{attrs:{label:"Printer",horizontal:"horizontal"}},[n("b-btn",{on:{click:e.testPrint}},[e._v("Test")])],1),n("b-form-group",{attrs:{label:"",horizontal:"horizontal"}},[n("b-btn",{attrs:{variant:"primary"},on:{click:e.saveSettings}},[e._v("Save")])],1)],1)],1)])},staticRenderFns:[]};var je=n("VU/8")(Fe,Ke,!1,function(e){n("hZB8")},"data-v-750aea81",null).exports,Ze={name:"Debug",mixins:[q],data:function(){return{putTimeout:5e3,saveTimeout:5e3,errorTimeout:1e3,putBlinkInterval:500,searchBrightness:100,ui:{r:255,g:0,b:0,isPause:!1,isAll:!1},cmd:{color:"ff0000",duration:200,repeat:10,led:["1"]}}},watch:{"ui.isAll":function(e){this.cmd.led=e?["all"]:[1]}},methods:{}},qe={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"row"},[n("div",{staticClass:"col-sm-7"},[n("h1",[e._v("Debug")]),n("b-form",{staticClass:"mt-3"},[n("b-form-group",{attrs:{label:"Color"}},[n("b-input-group",[n("b-form-input",{model:{value:e.cmd.color,callback:function(t){e.$set(e.cmd,"color",t)},expression:"cmd.color"}}),n("b-input-group-append",[n("b-btn",{attrs:{variant:"outline-info"},on:{click:function(t){e.cmd.color="ff0000"}}},[e._v("Red")]),n("b-btn",{attrs:{variant:"outline-info"},on:{click:function(t){e.cmd.color="00ff00"}}},[e._v("Green")]),n("b-btn",{attrs:{variant:"outline-info"},on:{click:function(t){e.cmd.color="0000ff"}}},[e._v("Blue")]),n("b-btn",{attrs:{variant:"outline-info"},on:{click:function(t){e.cmd.color="ff5500"}}},[e._v("Yellow")]),n("b-btn",{attrs:{variant:"outline-info"},on:{click:function(t){e.cmd.color="ffffff"}}},[e._v("White")])],1)],1)],1),n("b-form-group",[n("b-form-input",{attrs:{type:"range",min:"0",max:"255"},model:{value:e.ui.r,callback:function(t){e.$set(e.ui,"r",t)},expression:"ui.r"}}),n("b-form-input",{attrs:{type:"range",min:"0",max:"255"},model:{value:e.ui.g,callback:function(t){e.$set(e.ui,"g",t)},expression:"ui.g"}}),n("b-form-input",{attrs:{type:"range",min:"0",max:"255"},model:{value:e.ui.b,callback:function(t){e.$set(e.ui,"b",t)},expression:"ui.b"}})],1),n("b-form-group",{attrs:{label:"Duration"}},[n("b-input-group",{attrs:{append:""+e.cmd.duration}},[n("b-form-input",{attrs:{type:"range",min:"10",max:"10000"},model:{value:e.cmd.duration,callback:function(t){e.$set(e.cmd,"duration",t)},expression:"cmd.duration"}})],1)],1),n("b-form-group",{attrs:{label:"Repeat"}},[n("b-input-group",{attrs:{append:""+e.cmd.repeat}},[n("b-form-input",{attrs:{type:"range",min:"1",max:"100"},model:{value:e.cmd.repeat,callback:function(t){e.$set(e.cmd,"repeat",t)},expression:"cmd.repeat"}})],1)],1),n("b-form-group",{attrs:{label:"Pause"}},[n("b-input-group",{attrs:{append:""+e.ui.isPause?e.cmd.pause:e.cmd.duration}},[n("b-input-group-prepend",[n("b-form-checkbox",{model:{value:e.ui.isPause,callback:function(t){e.$set(e.ui,"isPause",t)},expression:"ui.isPause"}})],1),n("b-form-input",{attrs:{type:"range",min:"10",disabled:!e.ui.isPause,max:"10000"},model:{value:e.cmd.pause,callback:function(t){e.$set(e.cmd,"pause",t)},expression:"cmd.pause"}})],1)],1),n("b-form-group",{attrs:{label:"LED"}},[n("b-form-checkbox",{model:{value:e.ui.isAll,callback:function(t){e.$set(e.ui,"isAll",t)},expression:"ui.isAll"}},[e._v("All leds")]),n("b-form-select",{attrs:{multiple:"multiple",options:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20]},model:{value:e.cmd.led,callback:function(t){e.$set(e.cmd,"led",t)},expression:"cmd.led"}})],1)],1)],1),n("div",{staticClass:"col-sm-3"},[n("pre",[e._v(e._s(e.cmd))]),n("b-form-group",[n("b-button",{on:{click:function(t){e.$ledon(e.cmd)}}},[e._v("On")]),n("b-button",{attrs:{variant:"outline-info"},on:{click:e.$ledoff}},[e._v("Off")])],1)],1)])},staticRenderFns:[]};var Ve=n("VU/8")(Ze,qe,!1,function(e){n("oTkd")},"data-v-9ba0187a",null).exports,Ye={name:"Sortplan",computed:l()({},Object(d.c)({settings:"getSettingsSelected"})),mounted:function(){this.$bus.$on("keyboard:keydown:enter",this.bindBag),this.$bus.$on("keyboard:keydown:enter:SETUP",this.bindWizardToggle)},beforeDestroy:function(){this.$bus.$off("keyboard:keydown:enter",this.bindBag),this.$bus.$off("keyboard:keydown:enter:SETUP",this.bindWizardToggle)},data:function(){return{formInput:null,plan:null,bagIndex:null,bagLed:null,isBindWizardStarted:!1,isBindWizardStartedbindBagByIndex:!1,tmBindWizard:null,registerBagClickedNo:0,sortplan:{}}},mixins:[q],methods:l()({},Object(d.b)(["settingsUpdate"]),{editBag:function(e,t){console.log("editBag",e),this.bagIndex=e,this.$refs.myModalRef.show()},deleteBag:function(e,t){console.log("deleteBag",e,t),r.default.delete(this.settings.destinations,e),this.settingsUpdate(this.settings),this.$deletePoint(t)},bindWizardToggle:function(){var e=this;this.isBindWizardStarted=!this.isBindWizardStarted,console.log("isBindWizardStarted",this.isBindWizardStarted),this.isBindWizardStarted?(this.$bindStart(),this.autoStopWizard(1e4),window.setTimeout(function(){e.bagLed=0,e.$bind(e.bagLed)},1500)):this.autoStopWizard(100)},bindBagByIndex:function(e){console.log("bindBagByIndex",e),this.isBindWizardStarted=!0,this.isBindWizardStartedbindBagByIndex=!0,this.bagLed=e,this.$bind(this.bagLed),this.autoStopWizard(1e4)},bindBag:function(e){console.log("bindBag",e),this.isBindWizardStarted?(console.log("bindBag",e),this.bagIndex=e,this.settings.destinations[this.bagLed]=this.bagIndex,this.isBindWizardStartedbindBagByIndex?this.autoStopWizard(500):(this.bagLed++,this.$bind(this.bagLed),this.autoStopWizard())):this.bindWizardToggle()},autoStopWizard:function(e){var t=this;window.clearTimeout(this.tmBindWizard),this.tmBindWizard=window.setTimeout(function(){console.log("autoStopWizard"),t.isBindWizardStarted=!1,t.isBindWizardStartedbindBagByIndex=!1,t.bagLed=null,t.formInput=null,t.$bindEnd()},e||5e3)},fetchSortplan:function(){console.log("fetchSortplan")},printSortplan:function(){console.log("printSortplan")},clearDemo:function(){console.log("clearDemo"),this.settings.destinations=new Array(this.settings.destinations.length),this.settingsUpdate(this.settings)}})},He={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"row"},[n("div",{staticClass:"col-sm-11"},[n("h1",[e._v("Сортплан")]),n("b-form",{staticClass:"mt-3",on:{submit:function(t){t.preventDefault(),e.bindBag(e.formInput),e.formInput=""}}},[n("b-form-group",{attrs:{label:"Индекс/Мешок",horizontal:"horizontal"}},[n("b-form-input",{attrs:{disabled:!e.isBindWizardStarted},model:{value:e.formInput,callback:function(t){e.formInput=t},expression:"formInput"}})],1)],1),n("b-row",[n("b-col",[n("h3",[e._v("Полки "),n("b-btn-group",[n("b-btn",{class:{"btn-info":e.isBindWizardStarted},attrs:{size:"sm"},on:{click:e.bindWizardToggle}},[e._v("Калибровка")]),n("b-btn",{attrs:{size:"sm",variant:"danger"},on:{click:e.clearDemo}},[e._v("Clear Demo")])],1),n("b-btn-group",{staticClass:"float-right"},[n("b-btn",{attrs:{size:"sm"},on:{click:e.printSortplan}},[e._v("Распечатать")]),n("b-btn",{attrs:{size:"sm"},on:{click:e.fetchSortplan}},[e._v("Обновить")])],1)],1),n("b-card-group",{staticClass:"polkas",attrs:{deck:"deck"}},e._l(e.settings.destinations,function(t,o){return n("b-card",{key:o,attrs:{variant:"primary","bg-variant":e.bagLed==o?"danger":"","text-variant":e.bagLed==o?"white":"",align:"center","no-body":"no-body"},on:{click:function(t){e.bindBagByIndex(o)},contextmenu:function(n){e.deleteBag(o,t)}}},[n("b-card-header",[e._v(e._s(t?""+t:"Empty")),n("b-btn",{staticClass:"close",on:{click:function(n){n.stopPropagation(),e.editBag(t,o)}}},[e._v("+")])],1),n("b-card-body",[n("h4",{staticClass:"card-title"},[e._v(e._s(""+(o+1)))])])],1)}))],1)],1)],1),n("b-modal",{ref:"myModalRef",attrs:{"no-fade":"no-fade","header-bg-variant":"primary","header-text-variant":"white","ok-title":"Сохранить","cancel-title":"Отмена"},on:{close:function(t){e.bagIndex=null}}},[null!==e.bagIndex?n("template",{slot:"modal-title"},[e._v("Мешок 1 опорный индекс 1000 ")]):e._e(),null!==e.bagIndex?[n("h4",[e._v("Индексы ")]),n("b-form",{staticClass:"mt-3",on:{submit:function(t){t.preventDefault(),e.bindBag(e.formInput),e.formInput=""}}},[n("b-form-group",{attrs:{label:"Опорный Индекс"}},[n("b-form-input",{attrs:{disabled:!e.isBindWizardStarted},model:{value:e.formInput,callback:function(t){e.formInput=t},expression:"formInput"}})],1)],1),n("table",{staticClass:"table b-table mt-4"},e._l(e.sortplan[e.bagIndex],function(t,o){return n("tr",[n("td",[e._v(e._s(t))])])}))]:e._e()],2)],1)},staticRenderFns:[]};var Je=n("VU/8")(Ye,He,!1,function(e){n("WS33")},"data-v-1190ac18",null).exports;r.default.use(fe.a);var Xe=new fe.a({routes:[{path:"/console2",alias:"/",component:Ue,meta:{isPublic:!0}},{path:"/console",component:we},{path:"/admin",component:We,children:[{path:"sortplan",alias:"",component:Je},{path:"settings",component:je},{path:"debug",component:Ve}]}],linkActiveClass:"active",onError:function(e){console.error("Router Error",e)}}),Qe=(n("sax8"),n("mmfr")),et=n.n(Qe);r.default.use(et.a);var tt,nt=new et.a({version:1,database:"sortrack",schemas:[{settings:"point,meta_.updated"}],options:{settings:{type:"list",primary:"version",label:"version",updated_at:"meta_.updated"}}});function ot(e,t){var n=e.findIndex(function(e){return t==e.no});if(n<0)throw"Отправление "+t+" не привязано к плану ";return n}var st={state:{sortplan:null,barcode:null,response:null,closeResponse:null,error:null,depcode:localStorage.getItem("depcode"),autoDepcode:"200088",user:"SCNEVGENIA",demo:"true"===localStorage.getItem("demo"),ledOn:"true"===localStorage.getItem("ledOn"),selected:null,status:null,index:null},getters:{config:function(e,t){return t.getSettings[0]},getBags:function(e,t){return t.getSettings[0]?t.getSettings[0].bags:null},getConfig:function(e,t){return t.config},getSortplan:function(e){return e.sortplan},getBarcode:function(e){return e.barcode},getDepcode:function(e){return e.depcode},getAutoDepcode:function(e){return e.depcode?e.depcode:e.autoDepcode},getLedOn:function(e){return e.ledOn},getDemo:function(e){return e.demo},getStatus:function(e){return e.status},getUser:function(e){return e.user},getError:function(e){return e.error},getResponse:function(e){return e.response},getCloseResponse:function(e){return e.closeResponse},getSelected:function(e){return e.selected},getSelectedBag:function(e,t){if(e.selected)return t.getBags[t.cursor]},cursor:function(e,t){if(e.selected)return t.getBags.findIndex(function(t){return e.selected==t.no})},bagMetaData:function(e,t){if(t.getSelectedBag)return t.getSelectedBag.wpi[ne()(t.getSelectedBag.wpi)[0]]}},actions:{$initBags:function(e){e.commit,e.dispatch,e.state;var t=e.getters;console.log("initBags",t.getConfig.size),t.getConfig.bags=[].concat(ye()(new Array(Number(t.getConfig.size)||24))).map(function(e,t){return{no:"#"+t,led:null,index:"#"+t,wpi:{}}})},$saveConfig:function(e){e.commit;var t=e.dispatch;e.state;t("settingsUpdate",e.getters.getSettings[0])},$clear:function(e){e.commit,e.dispatch;var t=e.state;e.getters;t.response=null,t.closeResponse=null,t.barcode=null,t.status=null,t.error=null,t.selected=null},$selectBag:function(e,t){e.commit,e.dispatch;var n=e.state,o=e.getters,s=t.bagno;return new b.a(function(e,t){try{ot(o.getBags,s),n.selected=s,n.status="selectbag",e(s)}catch(e){n.error=e,n.status="error",t(e)}})},$deselectBag:function(e){e.commit,e.dispatch;var t=e.state;e.getters;t.status="deselectbag",t.selected=null},$putToBag:function(e,t){e.commit;var n=e.dispatch,o=e.state,s=e.getters,a=t.barcode;return n("$clear"),o.barcode=a,o.status="search",Y(o.barcode,o.depcode,o.user).then(function(e){ot(s.getBags,e.data.next.bagNo),o.response=e.data,o.status="push",o.selected=e.data.next.bagNo,o.autoDepcode=e.data.p_depcode,console.log("ZputToBag barcode",o.barcode,o.selected);var t={};t[a]=e.data;var n=s.cursor;if(n>-1){var i=s.getSelectedBag.wpi;t=l()({},t,i)}else n=function(e,t){var n=e.findIndex(function(e){return e.no.startsWith("#")});n>-1&&(e[n].no=t);return n}(s.getBags,o.selected);return r.default.set(s.getBags[n],"wpi",t),e.data}).catch(function(e){throw o.status="error",o.error=e,console.log("errorzzz"),e})},$closeBag:function(e,t){e.commit,e.dispatch;var n=e.state,o=e.getters,s=t.bagno,a=t.weight,i=t.sendmeth,l=t.depcode;return console.log("closeBag",s,a,i),H(s,a,i,n.depcode,n.user).then(function(e){n.closeResponse=e.data;try{n.closeResponse.cli_info=function e(t){var n={};3==t.nodeType&&(n=t.nodeValue);if(t.hasChildNodes()&&1===t.childNodes.length&&3===t.childNodes[0].nodeType)n=t.childNodes[0].nodeValue;else if(t.hasChildNodes())for(var o=0;o<t.childNodes.length;o++){var s=t.childNodes.item(o),a=s.nodeName;if(void 0===n[a])n[a]=e(s);else{if(void 0===n[a].push){var r=n[a];n[a]=[],n[a].push(r)}n[a].push(e(s))}}return n}((new DOMParser).parseFromString(n.closeResponse.cli_info,"text/xml")).CLIINFO,n.closeResponse.cli_info.TO_DEP_NAME=l}catch(e){console.error("xml",e)}return r.default.set(o.getSelectedBag,"wpi",{}),n.status="closebag",e.data}).catch(function(e){console.log("error",e),n.status="error",n.closeResponse=e.response?e.response.data:{error:"catch"}})},$fillBags:function(e,t){e.commit;var n=e.dispatch,o=(e.state,e.getters),s=t.plan,a=new Array;f()(s).forEach(function(e,t){return a.push({no:e[0],led:null,index:e[1],wpi:{}})}),o.getConfig.bags=a,n("$saveConfig")},$fetchSortplan:function(e,t){e.commit,e.dispatch;var n=e.state,o=(e.getters,t.depcode);return J(o).then(function(e){return n.sortplan=e.data,e})},$remapSelectedBag:function(e,t){e.commit;var n=e.dispatch,o=(e.state,e.getters),s=t.bagno,a=t.led;console.log("remapSelectedBag",o.getSelectedBag,a),o.getSelectedBag.led=a,o.getSelectedBag.no=s,n("$saveConfig")}},mutations:(tt={},$e()(tt,"PUSH_TO_BAG",function(e,t,n,o){}),$e()(tt,"CLEAR_BAG",function(e,t){r.default.set(e.bags,t,{})}),tt)};r.default.use(d.a);var at=new d.a.Store({state:{hydrated:!1},mutations:{DELETE_INDEXED_DB:function(){}},modules:l()({},nt.modules,{polka:st}),getters:{hydrated:function(e){return e.hydrated}},plugins:[nt.plugin],strict:!1}),rt=(n("Jmt5"),n("9M+g"),n("HSQo")),it=n.n(rt),lt=new r.default;it()(r.default.prototype,{$bus:{get:function(){return lt}}});var dt=n("G+GS"),ct=n.n(dt);r.default.filter("json2html",function(e,t){return ct()(e,t)}),r.default.directive("focus",{inserted:function(e){e.focus()}}),r.default.use(be.a),r.default.use(ge.a),r.default.use(he),r.default.use(et.a),r.default.config.productionTip=!1,r.default.mixin({methods:{$resetData:function(e){console.log("reset global data =",this.$options.name),a()(this.$data,this.$options.data.call(this)),(null!==e&&e||null==e)&&this.$emit("reset",null)},$_clone:function(e){return a()({},e)},$:function(e){return document.querySelector(e)},$ArrayRemoveElement:function(e,t){var n=e.indexOf(t);-1!==n&&e.splice(n,1)}}}),new r.default({el:"#app",data:function(){return{online:!1,mqttOnline:!1}},created:function(){window.addEventListener("online",this.checkOnline),window.addEventListener("offline",this.checkOnline),this.checkOnline()},mounted:function(){},beforeDestroy:function(){window.removeEventListener("online",this.checkOnline),window.removeEventListener("offline",this.checkOnline)},router:Xe,store:at,methods:{checkOnline:function(){console.log("check online",navigator.onLine),this.online=navigator.onLine}},render:function(e){return e(ue)}})},PuYh:function(e,t){},QODJ:function(e,t){},WS33:function(e,t){},eUDQ:function(e,t){},hZB8:function(e,t){},iDF2:function(e,t){},oTkd:function(e,t){},wEtC:function(e,t){},zj2Q:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.f28a9d126f5fb0380958.js.map